!function(e,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):t(e.jQuery)}(this,function(e){"use strict";var t=function(s,i){this.$element=e(s),this.options=e.extend({},t.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"!=typeof this.options.autoSelect||this.options.autoSelect,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.itemLink=this.options.itemLink||this.itemLink,this.itemTitle=this.options.itemTitle||this.itemTitle,this.followLinkOnSelect=this.options.followLinkOnSelect||this.followLinkOnSelect,this.source=this.options.source,this.delay=this.options.delay,this.theme=this.options.theme&&this.options.themes&&this.options.themes[this.options.theme]||t.defaults.themes[t.defaults.theme],this.$menu=e(this.options.menu||this.theme.menu),this.$appendTo=this.options.appendTo?e(this.options.appendTo):null,this.fitToElement="boolean"==typeof this.options.fitToElement&&this.options.fitToElement,this.shown=!1,this.listen(),this.showHintOnFocus=("boolean"==typeof this.options.showHintOnFocus||"all"===this.options.showHintOnFocus)&&this.options.showHintOnFocus,this.afterSelect=this.options.afterSelect,this.afterEmptySelect=this.options.afterEmptySelect,this.addItem=!1,this.value=this.$element.val()||this.$element.text(),this.keyPressed=!1,this.focused=this.$element.is(":focus"),this.changeInputOnSelect=this.options.changeInputOnSelect||this.changeInputOnSelect,this.changeInputOnMove=this.options.changeInputOnMove||this.changeInputOnMove,this.openLinkInNewTab=this.options.openLinkInNewTab||this.openLinkInNewTab,this.selectOnBlur=this.options.selectOnBlur||this.selectOnBlur,this.showCategoryHeader=this.options.showCategoryHeader||this.showCategoryHeader};t.prototype={constructor:t,setDefault:function(e){if(this.$element.data("live-search-selected",e),this.autoSelect||e){var t=this.updater(e);t||(t=""),this.$element.val(this.displayText(t)||t).text(this.displayText(t)||t).change(),this.afterSelect(t)}return this.hide()},select:function(){var e=this.$menu.find(".live-search-selected").data("value");if(this.$element.data("live-search-selected",e),this.autoSelect||e){var t=this.updater(e);t||(t=""),this.changeInputOnSelect&&this.$element.val(this.displayText(t)||t).text(this.displayText(t)||t).change(),this.followLinkOnSelect&&this.itemLink(e)?(this.openLinkInNewTab?window.open(this.itemLink(e),"_blank"):document.location=this.itemLink(e),this.afterSelect(t)):this.followLinkOnSelect&&!this.itemLink(e)?this.afterEmptySelect(t):this.afterSelect(t)}else this.afterEmptySelect();return this.hide()},updater:function(e){return e},setSource:function(e){this.source=e},show:function(){var t,s=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight}),i="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight;if(this.shown?t=this.$menu:this.$appendTo?(t=this.$menu.appendTo(this.$appendTo),this.hasSameParent=this.$appendTo.is(this.$element.parent())):(t=this.$menu.insertAfter(this.$element),this.hasSameParent=!0),!this.hasSameParent){t.css("position","fixed");var o=this.$element.offset();s.top=o.top,s.left=o.left}var n=e(t).parent().hasClass("dropup")?"auto":s.top+s.height+i,h=e(t).hasClass("dropdown-menu-right")?"auto":s.left;return t.css({top:n,left:h}).show(),!0===this.options.fitToElement&&t.css("width",this.$element.outerWidth()+"px"),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){if(null!=t?this.query=t:this.query=this.$element.val(),this.query.length<this.options.minLength&&!this.options.showHintOnFocus)return this.shown?this.hide():this;var s=e.proxy(function(){e.isFunction(this.source)&&3===this.source.length?this.source(this.query,e.proxy(this.process,this),e.proxy(this.process,this)):e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(s,this.delay)},process:function(t){var s=this;return(t=e.grep(t,function(e){return s.matcher(e)}),(t=this.sorter(t)).length||this.options.addItem)?(t.length>0?this.$element.data("live-search-selected",t[0]):this.$element.data("live-search-selected",null),"all"!=this.options.items&&(t=t.slice(0,this.options.items)),this.options.addItem&&t.push(this.options.addItem),this.render(t).show()):this.shown?this.hide():this},matcher:function(e){return~this.displayText(e).toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,s=[],i=[],o=[];t=e.shift();){var n=this.displayText(t);n.toLowerCase().indexOf(this.query.toLowerCase())?~n.indexOf(this.query)?i.push(t):o.push(t):s.push(t)}return s.concat(i,o)},highlighter:function(e){var t,s,i=this.query;if(""===i)return e;var o=e.match(/(>)([^<]*)(<)/g),n=[],h=[];if(o&&o.length)for(t=0;t<o.length;++t)o[t].length>2&&n.push(o[t]);else(n=[]).push(e);var a=RegExp(i=i.replace(/[\(\)\/\.\*\+\?\[\]]/g,function(e){return"\\"+e}),"g");for(t=0;t<n.length;++t)(s=n[t].match(a))&&s.length>0&&h.push(n[t]);for(t=0;t<h.length;++t)e=e.replace(h[t],h[t].replace(a,"<strong>$&</strong>"));return e},render:function(t){var s=this,i=this,o=!1,n=[],h=s.options.separator;return e.each(t,function(e,s){e>0&&s[h]!==t[e-1][h]&&n.push({__type:"divider"}),this.showCategoryHeader&&s[h]&&(0===e||s[h]!==t[e-1][h])&&n.push({__type:"category",name:s[h]}),n.push(s)}),t=e(n).map(function(t,n){if("category"==(n.__type||!1))return e(s.options.headerHtml||s.theme.headerHtml).text(n.name)[0];if("divider"==(n.__type||!1))return e(s.options.headerDivider||s.theme.headerDivider)[0];var h=i.displayText(n);return(t=e(s.options.item||s.theme.item).data("value",n)).find(s.options.itemContentSelector||s.theme.itemContentSelector).addBack(s.options.itemContentSelector||s.theme.itemContentSelector).html(s.highlighter(h,n)),s.options.followLinkOnSelect&&t.find("a").attr("href",i.itemLink(n)),t.find("a").attr("title",i.itemTitle(n)),h==i.$element.val()&&(t.addClass("live-search-selected"),i.$element.data("live-search-selected",n),o=!0),t[0]}),this.autoSelect&&!o&&(t.filter(":not(.dropdown-header)").first().addClass("live-search-selected"),this.$element.data("live-search-selected",t.first().data("value"))),this.$menu.html(t),this},displayText:function(e){return void 0!==e&&void 0!==e.name?e.name:e},itemLink:function(e){return null},itemTitle:function(e){return null},next:function(t){var s=this.$menu.find(".live-search-selected").removeClass("live-search-selected").next();for(s.length||(s=e(this.$menu.find(e(this.options.item||this.theme.item).prop("tagName"))[0]));s.hasClass("divider")||s.hasClass("dropdown-header");)s=s.next();s.addClass("live-search-selected");var i=this.updater(s.data("value"));this.changeInputOnMove&&this.$element.val(this.displayText(i)||i)},prev:function(t){var s=this.$menu.find(".live-search-selected").removeClass("live-search-selected").prev();for(s.length||(s=this.$menu.find(e(this.options.item||this.theme.item).prop("tagName")).last());s.hasClass("divider")||s.hasClass("dropdown-header");)s=s.prev();s.addClass("live-search-selected");var i=this.updater(s.data("value"));this.changeInputOnMove&&this.$element.val(this.displayText(i)||i)},listen:function(){this.$element.on("focus.bootstrap3Typeahead",e.proxy(this.focus,this)).on("blur.bootstrap3Typeahead",e.proxy(this.blur,this)).on("keypress.bootstrap3Typeahead",e.proxy(this.keypress,this)).on("propertychange.bootstrap3Typeahead input.bootstrap3Typeahead",e.proxy(this.input,this)).on("keyup.bootstrap3Typeahead",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown.bootstrap3Typeahead",e.proxy(this.keydown,this));var t=e(this.options.item||this.theme.item).prop("tagName");"ontouchstart"in document.documentElement&&"onmousemove"in document.documentElement?this.$menu.on("touchstart",t,e.proxy(this.touchstart,this)).on("touchend",t,e.proxy(this.click,this)).on("click",e.proxy(this.click,this)).on("mouseenter",t,e.proxy(this.mouseenter,this)).on("mouseleave",t,e.proxy(this.mouseleave,this)).on("mousedown",e.proxy(this.mousedown,this)):"ontouchstart"in document.documentElement?this.$menu.on("touchstart",t,e.proxy(this.touchstart,this)).on("touchend",t,e.proxy(this.click,this)):this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter",t,e.proxy(this.mouseenter,this)).on("mouseleave",t,e.proxy(this.mouseleave,this)).on("mousedown",e.proxy(this.mousedown,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("live-search-selected",null),this.$element.unbind("focus.bootstrap3Typeahead").unbind("blur.bootstrap3Typeahead").unbind("keypress.bootstrap3Typeahead").unbind("propertychange.bootstrap3Typeahead input.bootstrap3Typeahead").unbind("keyup.bootstrap3Typeahead"),this.eventSupported("keydown")&&this.$element.unbind("keydown.bootstrap3-typeahead"),this.$menu.remove(),this.destroyed=!0},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},move:function(e){if(this.shown)switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.shiftKey)return;e.preventDefault(),this.prev();break;case 40:if(e.shiftKey)return;e.preventDefault(),this.next()}},keydown:function(t){17!==t.keyCode&&(this.keyPressed=!0,this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.shown||40!=t.keyCode?this.move(t):this.lookup())},keypress:function(e){!this.suppressKeyPressRepeat&&this.move(e)},input:function(e){var t=this.$element.val()||this.$element.text();this.value!==t&&(this.value=t,this.lookup())},keyup:function(e){if(!this.destroyed)switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:if(!this.shown||this.showHintOnFocus&&!this.keyPressed)return;this.select();break;case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide()}},focus:function(e){!this.focused&&(this.focused=!0,this.keyPressed=!1,this.options.showHintOnFocus&&!0!==this.skipShowHintOnFocus&&("all"===this.options.showHintOnFocus?this.lookup(""):this.lookup())),this.skipShowHintOnFocus&&(this.skipShowHintOnFocus=!1)},blur:function(e){this.mousedover||this.mouseddown||!this.shown?this.mouseddown&&(this.skipShowHintOnFocus=!0,this.$element.focus(),this.mouseddown=!1):(this.selectOnBlur&&this.select(),this.hide(),this.focused=!1,this.keyPressed=!1)},click:function(e){e.preventDefault(),this.skipShowHintOnFocus=!0,this.select(),this.$element.focus(),this.hide()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".live-search-selected").removeClass("live-search-selected"),e(t.currentTarget).addClass("live-search-selected")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},mousedown:function(e){this.mouseddown=!0,this.$menu.one("mouseup",(function(e){this.mouseddown=!1}).bind(this))},touchstart:function(t){t.preventDefault(),this.$menu.find(".live-search-selected").removeClass("live-search-selected"),e(t.currentTarget).addClass("live-search-selected")},touchend:function(e){e.preventDefault(),this.select(),this.$element.focus()}};var s=e.fn.typeahead;e.fn.typeahead=function(s){var i=arguments;return"string"==typeof s&&"getActive"==s?this.data("live-search-selected"):this.each(function(){var o=e(this),n=o.data("typeahead");n||o.data("typeahead",n=new t(this,"object"==typeof s&&s)),"string"==typeof s&&n[s]&&(i.length>1?n[s].apply(n,Array.prototype.slice.call(i,1)):n[s]())})},t.defaults={source:[],items:8,minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:e.noop,afterEmptySelect:e.noop,addItem:!1,followLinkOnSelect:!1,delay:0,separator:"category",changeInputOnSelect:!0,changeInputOnMove:!1,openLinkInNewTab:!1,selectOnBlur:!0,showCategoryHeader:!0,theme:"yesilcms",themes:{yesilcms:{menu:'<div class="live-search" role="listbox"></div>',item:'<div class="dropdown-item"></div>',itemContentSelector:".dropdown-item",headerHtml:'<div class="dropdown-header"></div>',headerDivider:'<div class="divider" role="separator"></div>'}}},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=s,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var s=e(this);!s.data("typeahead")&&s.typeahead(s.data())})});